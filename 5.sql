create table EMPLOYEE(ssn varchar(10) primary key, fname varchar(10), lname varchar(10), address
varchar(20), sex varchar(1), salary integer, superssn varchar(10), dno integer);

create table DEPARTMENT(dno integer primary key, dname varchar(10), mgrstartdate date, mgrssn
varchar(10), foreign key(mgrssn) references EMPLOYEE(ssn) on delete cascade);

create table DLOCATION(dloc varchar(20), dno integer, foreign key (dno) references
DEPARTMENT(dno) on delete cascade);

create table PROJECT (pno integer primary key, pname varchar(20), plocation varchar(20), dno
integer, foreign key (dno) references DEPARTMENT(dno) on delete cascade);

create table WORKS_ON(hours integer, ssn varchar(10), foreign key (ssn) references EMPLOYEE(ssn)
on delete cascade, pno integer, foreign key (pno) references PROJECT(pno) on delete cascade,
primary key(ssn,pno));

INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('RNSECE01','JOHN','SCOTT','BANGALORE','M', 450000);

INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('RNSCSE01','JAMES','SMITH','BANGALORE','M', 500000);

INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('RNSCSE02','HEARN','BAKER','BANGALORE','M', 700000);

INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('RNSCSE03','EDWARD','SCOTT','MYSORE','M', 500000);

INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('RNSCSE04','PAVAN','HEGDE','MANGALORE','M', 650000);

INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('RNSCSE05','GIRISH','MALYA','MYSORE','M', 450000);

INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('RNSCSE06','NEHA','SN','BANGALORE','F', 800000);

INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('RNSACC01','AHANA','K','MANGALORE','F', 350000);

INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('RNSACC02','SANTHOSH','KUMAR','MANGALORE','M', 300000);

INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('RNSISE01','VEENA','M','MYSORE','M',
600000);

INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('RNSIT01','NAGESH','HR','BANGALORE','M', 500000);

INSERT INTO DEPARTMENT VALUES ('1','ACCOUNTS','2001-01-01','RNSACC02');

INSERT INTO DEPARTMENT VALUES ('2','IT','2016-08-01','RNSIT01');

INSERT INTO DEPARTMENT VALUES ('3','ECE','2008-06-01','RNSECE01');

INSERT INTO DEPARTMENT VALUES ('4','ISE',’2015-08-01','RNSISE01');

INSERT INTO DEPARTMENT VALUES ('5','CSE',’2002-06-01','RNSCSE05');

UPDATE EMPLOYEE SET SUPERSSN=NULL, DNO='3' WHERE SSN='RNSECE01';

UPDATE EMPLOYEE SET SUPERSSN='RNSCSE02', DNO='5' WHERE SSN='RNSCSE01';

UPDATE EMPLOYEE SET SUPERSSN='RNSCSE03', DNO='5' WHERE SSN='RNSCSE02';

UPDATE EMPLOYEE SET SUPERSSN='RNSCSE04', DNO='5' WHERE SSN='RNSCSE03';

UPDATE EMPLOYEE SET DNO='5', SUPERSSN='RNSCSE05' WHERE SSN='RNSCSE04';

UPDATE EMPLOYEE SET DNO='5', SUPERSSN='RNSCSE06' WHERE SSN='RNSCSE05';

UPDATE EMPLOYEE SET DNO='5', SUPERSSN=NULL WHERE SSN='RNSCSE06';

UPDATE EMPLOYEE SET DNO='1', SUPERSSN='RNSACC02' WHERE SSN='RNSACC01';

UPDATE EMPLOYEE SET DNO='1', SUPERSSN=NULL WHERE SSN='RNSACC02';

UPDATE EMPLOYEE SET DNO='4', SUPERSSN=NULL WHERE SSN='RNSISE01';

UPDATE EMPLOYEE SET DNO='2', SUPERSSN=NULL WHERE SSN='RNSIT01';

INSERT INTO DLOCATION VALUES ('BANGALORE', '1');

INSERT INTO DLOCATION VALUES ('BANGALORE', '2');

INSERT INTO DLOCATION VALUES ('BANGALORE', '3');

INSERT INTO DLOCATION VALUES ('MANGALORE', '4');

INSERT INTO DLOCATION VALUES ('MANGALORE', '5');

INSERT INTO PROJECT VALUES (100,'IOT','BANGALORE','5');

INSERT INTO PROJECT VALUES (101,'CLOUD','BANGALORE','5');

INSERT INTO PROJECT VALUES (102,'BIGDATA','BANGALORE','5');

INSERT INTO PROJECT VALUES (103,'SENSORS','BANGALORE','3');

INSERT INTO PROJECT VALUES (104,'BANK MANAGEMENT','BANGALORE','1');

INSERT INTO PROJECT VALUES (105,'SALARY MANAGEMENT','BANGALORE','1');

INSERT INTO PROJECT VALUES (106,'OPENSTACK','BANGALORE','4');

INSERT INTO PROJECT VALUES (107,'SMART CITY','BANGALORE','2');

INSERT INTO WORKS_ON VALUES (4, 'RNSCSE01', 100);

INSERT INTO WORKS_ON VALUES (6, 'RNSCSE01', 101);

INSERT INTO WORKS_ON VALUES (8, 'RNSCSE01', 102);

INSERT INTO WORKS_ON VALUES (10, 'RNSCSE02', 100);

INSERT INTO WORKS_ON VALUES (3, 'RNSCSE04', 100);

INSERT INTO WORKS_ON VALUES (4, 'RNSCSE05', 101);

INSERT INTO WORKS_ON VALUES (5, 'RNSCSE06', 102);

INSERT INTO WORKS_ON VALUES (6, 'RNSCSE03', 102);

INSERT INTO WORKS_ON VALUES (7, 'RNSECE01', 103);

INSERT INTO WORKS_ON VALUES (5, 'RNSACC01', 104);

INSERT INTO WORKS_ON VALUES (6, 'RNSACC02', 105);

INSERT INTO WORKS_ON VALUES (4, 'RNSISE01', 106);

INSERT INTO WORKS_ON VALUES (10, 'RNSIT01', 107);

-- Queries:
(select p.pno from PROJECT p, DEPARTMENT d, EMPLOYEE e
where p.dno = d.dno and d.mgrssn = e.ssn and e.lname = 'SCOTT')
UNION
(select p1.pno from PROJECT p1, WORKS_ON w, EMPLOYEE e1
where p1.pno = w.pno and e1.ssn = w.ssn and e1.lname = 'SCOTT');

select e.fname,e.lname,1.1*e.salary as INCR_SAL from EMPLOYEE e, WORKS_ON W, PROJECT p
where e.ssn = w.ssn and w.pno = p.pno and p.pname = 'IOT';

select sum(e.salary), max(e.salary), min(e.salary), avg(e.salary) from EMPLOYEE e, DEPARTMENT d
where d.dno = e.dno and d.dname = 'ACCOUNTS';

select e.fname, e.lname from EMPLOYEE e
where NOT EXISTS(
select pno from PROJECT where dno = 5
and pno not in
(select pno from WORKS_ON w where e.ssn=w.ssn));

select d.dno, count(*) from DEPARTMENT d, EMPLOYEE e where d.dno = e.dno and e.salary >
600000 and d.dno IN (select e1.dno from EMPLOYEE e1 group by e1.dno having count(*)>5) group
by d.dno;
